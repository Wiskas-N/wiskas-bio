<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>чипсики</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="background">
    <video id="bg-video" class="bg-video" loop playsinline muted preload="none">
        <source src="background.mp4" type="video/mp4">
    </video>
</div>

<div id="start-screen">
    <div class="start-title">Tap to enter</div>
</div>

<div class="container">
    <nav class="nav-menu">
        <div class="nav-link active" data-target="home">Главная</div>
        <div class="nav-link" data-target="about">Обо мне</div>
        <div class="nav-link" data-target="contacts">Контакты</div>
    </nav>

    <div id="home" class="section active">
        <div class="avatar">
            <img src="avatar.png" alt="avatar" class="avatar-img">
        </div>
        <h1>Wiskas</h1>
        <p class="bio-desc">
            Вам <span class="food-trigger">картошку фри</span> или 
            <span class="food-trigger">гамбургер</span>?
        </p>
        <p class="bio-location">
            <i class="fa-solid fa-location-dot"></i> Подвал
        </p>
    </div>

    <div id="about" class="section">
        <h1>Обо мне</h1>
        <p class="about-text">
            Я Захар. Живу во Вьетнаме и создаю всякие интересные штуки. Люблю чай и бургеры.
        </p>
        <div style="text-align: center;">
            <ul class="info-list">
                <li><i class="fa-solid fa-code"></i> Web-Designer</li>
                <li><i class="fa-solid fa-headphones"></i> Играю 25/8</li>
                <li><i class="fa-solid fa-pizza-slice"></i> Ценитель фастфуда</li>
            </ul>
        </div>
    </div>

    <div id="contacts" class="section">
        <h1>Контакты</h1>
        <div class="contact-list">
            <a href="https://t.me/wiskas_n" target="_blank" class="contact-item">
                <i class="fa-brands fa-telegram"></i> <span>Telegram</span>
            </a>
            <a href="https://discord.com/users/123456789012345678" target="_blank" class="contact-item">
                <i class="fa-brands fa-discord"></i> <span>Discord</span>
            </a>
        </div>
    </div>

    <div class="views-fixed">
        <i class="fa-solid fa-eye"></i>
        <span id="views">0</span>
    </div>
</div>

<div id="order-toast" class="order-toast">
    Заказ успешно оформлен!
</div>

<script>
const startScreen = document.getElementById('start-screen');
const bgVideo = document.getElementById('bg-video');

startScreen.addEventListener('click', async () => {
    try {
        bgVideo.muted = false;
        bgVideo.volume = 0.6;
        await bgVideo.play();
    } catch (e) {
        console.log('Playback blocked', e);
    }
    startScreen.classList.add('hidden');
}, { once: true });

document.querySelectorAll('.nav-link').forEach(link => {
    link.addEventListener('click', () => {
        const target = link.getAttribute('data-target');

        document.querySelectorAll('.nav-link')
            .forEach(l => l.classList.remove('active'));
        link.classList.add('active');

        document.querySelectorAll('.section')
            .forEach(sec => sec.classList.remove('active'));
        document.getElementById(target).classList.add('active');
    });
});

const toast = document.getElementById('order-toast');

document.querySelectorAll('.food-trigger').forEach(el => {
    el.addEventListener('click', () => {
        toast.classList.add('show');
        setTimeout(() => {
            toast.classList.remove('show');
        }, 1500);
    });
});
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, doc, setDoc, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSy...",
  authDomain: "wiskas.firebaseapp.com",
  projectId: "wiskas",
  storageBucket: "wiskas.firebasestorage.app",
  messagingSenderId: "168046348967",
  appId: "1:168046348967:web:618ed62b398042861ca982"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const bioRef = doc(db, "stats", "bio");

async function incrementViewOnce() {
  const counted = localStorage.getItem("bio_view_counted");
  if (!counted) {
    await setDoc(bioRef, { views: increment(1) }, { merge: true });
    localStorage.setItem("bio_view_counted", "true");
  }
}
incrementViewOnce();

onSnapshot(bioRef, snap => {
  if (!snap.exists()) return;
  document.getElementById("views").textContent = snap.data().views || 0;
});
</script>

</body>
</html>
